

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Connection Operations &mdash; RepoDb 1.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Transaction" href="transaction.html" />
    <link rel="prev" title="Connection Object" href="connection.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> RepoDb
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to RepoDb</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataentity.html">Creating a DataEntity</a></li>
<li class="toctree-l1"><a class="reference internal" href="mapattribute.html">Mapping with MapAttribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="attributes.html">Property Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiplemapping.html">Multiple Entity Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="typemapping.html">Type Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="connection.html">Connection Object</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Connection Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#batchquery-operation">BatchQuery Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bulkinsert-operation">BulkInsert Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#count-operation">Count Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#delete-operation">Delete Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deleteall-operation">DeleteAll Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executenonquery-operation">ExecuteNonQuery Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executequery-operation">ExecuteQuery Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executereader-operation">ExecuteReader Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executescalar-operation">ExecuteScalar Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inlineinsert-operation">InlineInsert Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inlinemerge-operation">InlineMerge Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inlineupdate-operation">InlineUpdate Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#insert-operation">Insert Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#merge-operation">Merge Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query-operation">Query Operation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ordering-the-result">Ordering the Result</a></li>
<li class="toctree-l3"><a class="reference internal" href="#limiting-the-query-result">Limiting the Query Result</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#truncate-operation">Truncate Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update-operation">Update Operation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transaction.html">Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="expressiontree.html">Expression Tree</a></li>
<li class="toctree-l1"><a class="reference internal" href="querygroup.html">Query Group Expressions</a></li>
<li class="toctree-l1"><a class="reference internal" href="repository.html">Working with Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectionpersistency.html">Connection Persistency</a></li>
<li class="toctree-l1"><a class="reference internal" href="repositoryoperations.html">Repository Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="cache.html">Working with Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="trace.html">Working with Trace</a></li>
<li class="toctree-l1"><a class="reference internal" href="statementbuilder.html">Working with StatementBuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance Benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensibility.html">Library Extensibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Supported Versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contacts</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">RepoDb</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Connection Operations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/pages/connectionoperations.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="connection-operations">
<h1>Connection Operations<a class="headerlink" href="#connection-operations" title="Permalink to this headline">Â¶</a></h1>
<p>A connection object contains different operations as extended methods to manipulate the data from the database. Below are the list of common operations widely used.</p>
<ul class="simple">
<li><strong>BatchQuery</strong>: is used to query a record from the database by batch. It returns an enumerable list of <cite>DataEntity</cite> object.</li>
<li><strong>BulkInsert</strong>: is used to bulk-insert the records in the database. It returns the number of inserted rows from the database.</li>
<li><strong>Count</strong>: is used to count all the records from the database. It returns the number of rows from the database based on the given query expression.</li>
<li><strong>Delete</strong>: is used to delete a record from the database. It returns the number of deleted rows from the database.</li>
<li><strong>DeleteAll</strong>: is used to delete all the records in the database. It returns the number of deleted rows from the database.</li>
<li><strong>ExecuteNonQuery</strong>: is used to execute a non-queryable SQL statement. It returns the number of affected from the database.</li>
<li><strong>ExecuteQuery</strong>: is used to read certain records from the database in fast-forward access. It returns an enumerable list of <cite>dynamic</cite> or <cite>DataEntity</cite> object.</li>
<li><strong>ExecuteReader</strong>: is used to execute a SQL statement query in the database in fast-forward access. This method returns an instance of <cite>System.Data.IDataReader</cite> object.</li>
<li><strong>ExecuteScalar</strong>: is used to execute a query statement that returns single value of type <cite>System.Object</cite>.</li>
<li><strong>InlineInsert</strong>: is used to do column-based insert of the records in the database. It returns the number of inserted rows from the database.</li>
<li><strong>InlineMerge</strong>: is used to do column-based merge of the records in the database. It returns the number of merged rows from the database.</li>
<li><strong>InlineUpdate</strong>: is used to do column-based update of the records in the database. It returns the number of updated rows from the database.</li>
<li><strong>Insert</strong>: is used to insert a record in the database. It returns the number of inserted rows from the database.</li>
<li><strong>Merge</strong>: is used to merge a record in the database. It returns the number of merged rows from the database.</li>
<li><strong>Query</strong>: is used to query a record from the database. It returns an enumerable list of <cite>DataEntity</cite> object.</li>
<li><strong>Truncate</strong>: is used to truncate a table in the database.</li>
<li><strong>Update</strong>: is used to update a record in the database. It returns the number of updated rows from the database.</li>
</ul>
<p>All operations mentioned above has its own corresponding asynchronous operation. Usually, the asynchronous operation is only appended by <cite>Async</cite> keyword. Below are the list of asynchronous operations.</p>
<ul class="simple">
<li><strong>BatchQueryAsync</strong></li>
<li><strong>BulkInsertAsync</strong></li>
<li><strong>CountAsync</strong></li>
<li><strong>DeleteAsync</strong></li>
<li><strong>DeleteAllAsync</strong></li>
<li><strong>ExecuteNonQueryAsync</strong></li>
<li><strong>ExecuteQueryAsync</strong></li>
<li><strong>ExecuteScalar</strong></li>
<li><strong>InlineInsertAsync</strong></li>
<li><strong>InlineMergeAsync</strong></li>
<li><strong>InlineUpdateAsync</strong></li>
<li><strong>InsertAsync</strong></li>
<li><strong>MergeAsync</strong></li>
<li><strong>QueryAsync</strong></li>
<li><strong>TruncateAsync</strong></li>
<li><strong>UpdateAsync</strong></li>
</ul>
<p><strong>Note</strong>: All operational extension methods of the <cite>System.Data.IDbConnection</cite> is being abstracted by both <cite>RepoDb.DbRepository</cite> and <cite>RepoDb.BaseRepository</cite> objects.</p>
<div class="section" id="batchquery-operation">
<h2>BatchQuery Operation<a class="headerlink" href="#batchquery-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Query the data from the database by batch based on the given query expression. The batching will vary on the page number and number of rows per batch defined by this operation. This operation is useful for paging purposes.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>where</strong>: The query expression or primary key value to be used by this operation.</li>
<li><strong>page</strong>: the page of the batch to be used by this operation.</li>
<li><strong>rowsPerBatch</strong>: the number of rows per batch to be used by this operation.</li>
<li><strong>orderBy</strong>: the order definition of the fields to be used by this operation.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction to be used by this operation.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: an enumerable list of <cite>DataEntity</cite> objects.</li>
</ul>
<p>Below is a sample on how to query the first batch of data from the database where the number of rows per batch is 24.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">0</span><span class="p">,</span> <span class="m">24</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below is the way to query by batch the data with expression.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="m">0</span><span class="p">,</span> <span class="m">24</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Batching is very important when you are lazy-loading the data from the database. Below is a sample event listener for scroll (objects), doing the batch queries and post-process the data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">scroller</span> <span class="p">=</span> <span class="p">&lt;</span><span class="n">Any</span> <span class="n">Customimzed</span> <span class="n">Scroller</span> <span class="n">Object</span><span class="p">&gt;</span>
<span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">();</span>
<span class="kt">var</span> <span class="n">page</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">rowsPerBatch</span> <span class="p">=</span> <span class="m">24</span><span class="p">;</span>

<span class="n">scroller</span><span class="p">.</span><span class="n">ScrollToEnd</span> <span class="p">+=</span> <span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">page</span><span class="p">,</span> <span class="n">rowsPerBatch</span><span class="p">);</span>
        <span class="n">Process</span><span class="p">(</span><span class="n">result</span><span class="p">);</span>
        <span class="n">page</span><span class="p">++;</span>
<span class="p">};</span>

<span class="k">void</span> <span class="nf">Process</span><span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;</span> <span class="n">orders</span><span class="p">)</span>
<span class="p">{</span>
        <span class="c1">// Process the orders (display on the page)</span>
<span class="p">}</span>

<span class="k">void</span> <span class="nf">Dispose</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Dispose</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="bulkinsert-operation">
<h2>BulkInsert Operation<a class="headerlink" href="#bulkinsert-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Bulk-inserting the list of &lt;i&gt;DataEntity&lt;/i&gt; objects in the database.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entities</strong>: the list of entities to be inserted.</li>
<li><strong>transaction (optional)</strong>: the transaction object to be used when doing bulk-insert.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>returns</strong>: an instance of integer that holds the number of rows affected by the execution.</li>
</ul>
<p>Below is a sample on how to do bulk-insert.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">entities</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>
        <span class="n">entities</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
        <span class="p">{</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span><span class="p">,</span>
                <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
                <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">});</span>
        <span class="n">entities</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
        <span class="p">{</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">25</span><span class="p">,</span>
                <span class="n">ProductId</span> <span class="p">=</span> <span class="m">15</span><span class="p">,</span>
                <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
                <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">});</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">entities</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="count-operation">
<h2>Count Operation<a class="headerlink" href="#count-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Counts the number of rows from the database based on the given query expression.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>where</strong>: The query expression or primary key value to be used by this operation.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction to be used by this operation.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: an integer value for the number of rows counted from the database based on the given query expression.</li>
</ul>
<p>Below is a sample on how to count a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">rows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Count</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code snippets above will count all the <cite>Customer</cite> records from the database.</p>
<p>Below is the sample way to count a records with expression</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">rows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Count</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Above code snippets will count all the <cite>Customer</cite> records from the database where <cite>Id</cite> is greater than or equals to <cite>10045</cite>.</p>
</div>
<div class="section" id="delete-operation">
<h2>Delete Operation<a class="headerlink" href="#delete-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Deletes a data in the database based on the given query expression. It returns an instance of integer that holds the number of rows affected by the execution.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>where</strong>: The query expression or primary key value to be used by this operation. When is set to <cite>NULL</cite>, it deletes all the data from the database.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used when executing the query in the database.</li>
<li><strong>transaction (optional)</strong>: the transaction object to be used when deleting a data.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: an instance of integer that holds the number of rows affected by the execution.</li>
</ul>
<p>Below is a sample on how to delete a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">251</span><span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">customer</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">customer</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>or by <cite>PrimaryKey</cite></p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">251</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Deleting a by passing a <cite>DataEntity</cite> will throw a <cite>PrimaryFieldNotFoundException</cite> exception back to the caller if the <cite>PrimaryKey</cite> is not found from the entity.</p>
<p><strong>Note</strong>: By leaving the <cite>WHERE</cite> parameter to blank would delete all records. Exactly the same operation as <cite>DeleteAll</cite>.</p>
</div>
<div class="section" id="deleteall-operation">
<h2>DeleteAll Operation<a class="headerlink" href="#deleteall-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Deletes all data in the database based on the target <cite>DataEntity</cite>.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used when executing the query in the database.</li>
<li><strong>transaction (optional)</strong>: the transaction object to be used when deleting a data.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: an instance of integer that holds the number of rows affected by the execution.</li>
</ul>
<p>Below is a sample on how to delete all the data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">DeleteAll</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="executenonquery-operation">
<h2>ExecuteNonQuery Operation<a class="headerlink" href="#executenonquery-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Executes a query from the database. It uses the underlying <cite>ExecuteNonQuery</cite> method of the <cite>System.Data.IDbCommand</cite> object and returns the number of affected rows during the execution.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: The command text to be used on the execution.</li>
<li><strong>param (optional)</strong>: The dynamic object to be used as parameter. This object must contain all the values for all the parameters defined in the <cite>CommandText</cite> property.</li>
<li><strong>commandType (optional)</strong>: the command type to be used on the execution.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction to be used on the execution (if present).</li>
</ul>
<p>Below is the way on how to call the operation.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;UPDATE [dbo].[Order] SET Quantity = @Quantity, UpdatedDate = @UpdatedDate WHERE (CustomerId = @CustomerId);&quot;</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="executequery-operation">
<h2>ExecuteQuery Operation<a class="headerlink" href="#executequery-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Executes a query from the database. It uses the underlying <cite>ExecuteReader</cite> method of the <cite>System.Data.IDbCommand</cite> object and converts the result back to an enumerable list of <cite>DataEntity</cite> object.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: The command text to be used on the execution.</li>
<li><strong>param (optional)</strong>: The dynamic object to be used as parameter. This object must contain all the values for all the parameters defined in the <cite>CommandText</cite> property.</li>
<li><strong>commandType (optional)</strong>: the command type to be used on the execution.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction to be used on the execution (if present).</li>
</ul>
<p>Below is the way on how to call the operation.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="s">&quot;SELECT * FROM [dbo].[Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="executereader-operation">
<h2>ExecuteReader Operation<a class="headerlink" href="#executereader-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Executes a query from the database. It uses the underlying <cite>ExecuteReader</cite> method of the <cite>System.Data.IDbCommand</cite> object and returns the instance of the data reader.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: The command text to be used on the execution.</li>
<li><strong>param (optional)</strong>: The dynamic object to be used as parameter. This object must contain all the values for all the parameters defined in the <cite>CommandText</cite> property.</li>
<li><strong>commandType (optional)</strong>: the command type to be used on the execution.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction to be used on the execution (if present).</li>
</ul>
<p>Below is the way on how to call the operation.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;SELECT * FROM [dbo].[Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}))</span>
        <span class="p">{</span>
                <span class="c1">// Use the data reader here</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="executescalar-operation">
<h2>ExecuteScalar Operation<a class="headerlink" href="#executescalar-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Executes a query from the database. It uses the underlying <cite>ExecuteScalar</cite> method of the <cite>System.Data.IDbCommand</cite> object and returns the first occurence value (first column of first row) of the execution.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>commandText</strong>: The command text to be used on the execution.</li>
<li><strong>param (optional)</strong>: The dynamic object to be used as parameter. This object must contain all the values for all the parameters defined in the <cite>CommandText</cite> property.</li>
<li><strong>commandType (optional)</strong>: the command type to be used on the execution.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction to be used on the execution (if present).</li>
</ul>
<p>Below is the way on how to call the operation.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteScalar</span><span class="p">(</span><span class="s">&quot;SELECT MAX([Id]) AS MaxId FROM [dbo].[Order]&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="inlineinsert-operation">
<h2>InlineInsert Operation<a class="headerlink" href="#inlineinsert-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Inserts a data in the database by targetting certain fields only.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the object that contains the targetted columns to be inserted.</li>
<li><strong>overrideIgnore (optional)</strong>: set to <cite>true</cite> if to allow the insert operation on the properties with <cite>RepoDb.Attributes.IgnoreAttribute</cite> defined.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction object to be used when updating a data.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: the value of the <cite>PrimaryKey</cite> of the newly inserted <cite>DataEntity</cite> object. Returns <cite>NULL</cite> if the <cite>PrimaryKey</cite> property is not present.</li>
</ul>
<p>Below is a sample on how to do inline insert.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InlineInsert</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span>
        <span class="p">{</span>
                <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                <span class="n">ProductId</span> <span class="p">=</span> <span class="m">35</span><span class="p">,</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code snippets above will insert the <cite>CustomerId</cite>, <cite>ProductId</cite>, <cite>Quantity</cite> and <cite>CreatedDate</cite> columns of the <cite>Order</cite> table. It will set the other columns to <cite>NULL</cite>.</p>
</div>
<div class="section" id="inlinemerge-operation">
<h2>InlineMerge Operation<a class="headerlink" href="#inlinemerge-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Merges a data in the database by targetting certain fields only.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the object that contains the targetted columns to be inserted.</li>
<li><strong>qualifiers</strong>: the list of the qualifier fields to be used by the inline merge operation on a SQL Statement.</li>
<li><strong>overrideIgnore (optional)</strong>: set to <cite>true</cite> if to allow the insert operation on the properties with <cite>RepoDb.Attributes.IgnoreAttribute</cite> defined.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction object to be used when updating a data.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: an instance of integer that holds the number of rows affected by the execution.</li>
</ul>
<p>Below is a sample on how to do inline merge.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InlineMerge</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                <span class="n">ProductId</span> <span class="p">=</span> <span class="m">35</span><span class="p">,</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">},</span>
        <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code snippets above will merge the <cite>Order</cite> record into the database by inserting the value of the <cite>ProductId</cite>, <cite>Quantity</cite> and <cite>UpdatedDate</cite> columns if the record with <cite>Id</cite> equals to <cite>10045</cite> is not yet in the database. Otherwise, it will update the existing records.</p>
<p><strong>Note</strong>: It is necessary to define the qualifier fields, and the qualifier fields must be present on the dynamic object passed at <cite>entity</cite> parameter. Please also note that the <cite>Merge</cite> operation is only using the <cite>Equal</cite> operation when merging the data in the database. Other operations of like (<cite>GreaterThan</cite>, <cite>LessThan</cite>) is not supported. One can create a advance SQL Statement or Stored Procedure for merging process and call the <cite>ExecuteNonQuery</cite> method instead.</p>
</div>
<div class="section" id="inlineupdate-operation">
<h2>InlineUpdate Operation<a class="headerlink" href="#inlineupdate-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Updates a data in the database by targetting certain fields only.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the object that contains the targetted columns to be inserted.</li>
<li><strong>where</strong>: The query expression or primary key value to be used by this operation.</li>
<li><strong>overrideIgnore (optional)</strong>: set to <cite>true</cite> if to allow the insert operation on the properties with <cite>RepoDb.Attributes.IgnoreAttribute</cite> defined.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction object to be used when updating a data.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: an instance of integer that holds the number of rows affected by the execution.</li>
</ul>
<p>Below is a sample on how to do inline merge.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InlineUpdate</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Anna Fullerton&quot;</span><span class="p">,</span>
                <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">},</span>
        <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The code snippets above will update the <cite>Name</cite> field to <cite>Anna Fullerton</cite> and the <cite>UpdatedDate</cite> field to <cite>DateTime.UtcNow</cite> of the <cite>Customer</cite> record where the <cite>Id</cite> is equals to <cite>10045</cite>.</p>
<p>Please note, that in the <cite>InlineUpdate</cite> operation, only the fields defined at the <cite>entity</cite> parameters are being included in the context.</p>
<p>The codes above will generate the SQL Statement below.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="n">UPDATE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Customer</span><span class="p">]</span> <span class="n">SET</span> <span class="n">Name</span> <span class="p">=</span> <span class="n">@Name</span><span class="p">,</span> <span class="n">UpdateDate</span> <span class="p">=</span> <span class="n">@UpdatedDate</span> <span class="n">WHERE</span> <span class="n">Id</span> <span class="p">=</span> <span class="n">@Id</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="insert-operation">
<h2>Insert Operation<a class="headerlink" href="#insert-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Inserts a data in the database.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the entity object to be inserted.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction object to be used when updating a data.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: an instance of integer that holds the number of rows affected by the execution.</li>
</ul>
<p>Below is a sample on how to insert a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
        <span class="p">{</span>
                <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="merge-operation">
<h2>Merge Operation<a class="headerlink" href="#merge-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Merges an existing <cite>DataEntity</cite> object in the database.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the entity object to be merged.</li>
<li><strong>qualifiers</strong>: the list of fields to be used as the qualifiers when merging a record.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction object to be used when updating a data.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: an instance of integer that holds the number of rows affected by the execution.</li>
</ul>
<p>Below is a sample on how to merge a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">1</span><span class="p">);</span>
        <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">new</span> <span class="p">{</span> <span class="n">order</span><span class="p">.</span><span class="n">Id</span> <span class="p">}));</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note</strong>: The merge is a process of updating and inserting. If the data is present in the database using the qualifiers, then the existing data will be updated, otherwise, a new data will be inserted in the database.</p>
</div>
<div class="section" id="query-operation">
<h2>Query Operation<a class="headerlink" href="#query-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Query a data from the database based on the given query expression.</p>
<ul class="simple">
<li><strong>where</strong>: The query expression or primary key value to be used by this operation.</li>
<li><strong>top</strong>: the value used to return certain number of rows from the database.</li>
<li><strong>orderBy</strong>: the list of fields to be used to sort the data during querying.</li>
<li><strong>cacheKey</strong>: the key of the cache to check.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction object to be used when updating a data.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: an enumerable list of <cite>DataEntity</cite> object.</li>
</ul>
<p>Below is a sample on how to query a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Above snippet will return all the <cite>Customer</cite> records from the database. The data can filtered using the <cite>where</cite> parameter. See sample below.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">105</span><span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Below is the sample on how to query with multiple columns.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">Name</span> <span class="p">=</span> <span class="s">&quot;Anna Fullerton&quot;</span><span class="p">,</span> <span class="n">Conjunction</span><span class="p">.</span><span class="n">Or</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>When querying a data where <cite>Id</cite> field is greater than 50 and less than 100. See sample expressions below.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">Between</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[]</span> <span class="p">{</span> <span class="m">50</span><span class="p">,</span> <span class="m">100</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
        <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;</span>
        <span class="p">(</span>
                <span class="k">new</span>
                <span class="p">{</span>
                        <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span>
                        <span class="p">{</span>
                                <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">All</span><span class="p">,</span>
                                <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">object</span><span class="p">[]</span>
                                <span class="p">{</span>
                                        <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThanOrEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">50</span> <span class="p">},</span>
                                        <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">LessThanOrEqual</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">100</span> <span class="p">}</span>
                                <span class="p">}</span>
                        <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note</strong>: Querying a record using <cite>PrimaryKey</cite> will throw a <cite>PrimaryFieldNotFoundException</cite> exception back to the caller if the <cite>PrimaryKey</cite> is not found from the entity.</p>
<div class="section" id="ordering-the-result">
<h3>Ordering the Result<a class="headerlink" href="#ordering-the-result" title="Permalink to this headline">Â¶</a></h3>
<p>An ordering is the way of sorting the result of your query in <cite>Ascending</cite> or <cite>Descending</cite> order, depending on the qualifier fields.</p>
<p>Below is a sample snippet that returns the <cite>Customer</cite> records ordered by <cite>ParentId</cite> field in ascending manner and <cite>Name</cite> field is in <cite>descending</cite> manner.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orderBy</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Name</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Descending</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">In</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span> <span class="m">100</span><span class="p">,</span> <span class="m">200</span> <span class="p">}</span> <span class="p">}</span> <span class="p">},</span> <span class="n">orderBy</span><span class="p">:</span> <span class="n">OrderField</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="n">orderBy</span><span class="p">));</span>
        <span class="n">customers</span><span class="p">.</span><span class="n">ToList</span><span class="p">().</span><span class="n">ForEach</span><span class="p">(</span><span class="n">customer</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
                <span class="c1">// Process each Customer here</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <cite>RepodDb.OrderField</cite> is an object that is being used to order a query result. The <cite>Parse</cite> method is used to convert the <cite>dynamic</cite> object to become an <cite>OrderField</cite> instances.</p>
<p><strong>Note:</strong> When composing a dynamic ordering object, the value of the properties should be equal to <cite>RepoDb.Enumerations.Order</cite> values (<cite>Ascending</cite> or <cite>Descending</cite>). Otherwise, an exception will be thrown during <cite>OrderField.Parse</cite> operation.</p>
</div>
<div class="section" id="limiting-the-query-result">
<h3>Limiting the Query Result<a class="headerlink" href="#limiting-the-query-result" title="Permalink to this headline">Â¶</a></h3>
<p>A top parameter is used to limit the result when querying a data from the database.</p>
<p>Below is a sample way on how to use the top parameter.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Operation</span> <span class="p">=</span> <span class="n">Operation</span><span class="p">.</span><span class="n">GreaterThan</span><span class="p">,</span> <span class="n">Value</span> <span class="p">=</span> <span class="m">1</span> <span class="p">}</span> <span class="p">},</span> <span class="n">top</span><span class="p">:</span> <span class="m">100</span><span class="p">);</span>
        <span class="n">customers</span><span class="p">.</span><span class="n">ToList</span><span class="p">().</span><span class="n">ForEach</span><span class="p">(</span><span class="n">customer</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
                <span class="c1">// Process each Customer here</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="truncate-operation">
<h2>Truncate Operation<a class="headerlink" href="#truncate-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Truncates a table from the database.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the entity object to be updated.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
</ul>
<p>Below is a sample on how to truncate a table.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Truncate</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="update-operation">
<h2>Update Operation<a class="headerlink" href="#update-operation" title="Permalink to this headline">Â¶</a></h2>
<p>Updates a data in the database based on the given query expression.</p>
<p>Below are the parameters:</p>
<ul class="simple">
<li><strong>entity</strong>: the entity object to be updated.</li>
<li><strong>where</strong>: The query expression or primary key value to be used by this operation.</li>
<li><strong>commandTimeout (optional)</strong>: the command timeout in seconds to be used on the execution.</li>
<li><strong>transaction (optional)</strong>: the transaction object to be used when updating a data.</li>
<li><strong>trace (optional)</strong>: the trace object to be used by this operation.</li>
<li><strong>statementBuilder (optional)</strong>: the statement builder object to be used by this operation.</li>
<li><strong>returns</strong>: an instance of integer that holds the number of rows affected by the execution.</li>
</ul>
<p>Below is a sample on how to update a data.</p>
<div class="highlight-c# notranslate"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">105</span><span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">order</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
                <span class="n">order</span><span class="p">.</span><span class="n">UpdateDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
                <span class="kt">var</span> <span class="n">affectedRows</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note</strong>:  Updating a record using <cite>PrimaryKey</cite> will throw a <cite>PrimaryFieldNotFoundException</cite> exception back to the caller if the <cite>PrimaryKey</cite> is not found from the entity.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="transaction.html" class="btn btn-neutral float-right" title="Transaction" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="connection.html" class="btn btn-neutral" title="Connection Object" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Michael Camara Pendon.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>